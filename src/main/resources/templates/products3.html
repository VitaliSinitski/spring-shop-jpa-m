<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
    <meta charset="UTF-8">
    <title>Products</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/styles.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/footer.css}"/>
</head>

<body>

<!-- Include header -->
<div th:include="header.html"></div>

<!-- Include menu -->
<div class="menu">
    <div th:include="menu.html"></div>
</div>

<!-- Display all products -->
<div class="container">

    <br>
    <div>
        <!--        should add value parameter not to erase all data after go back-->
        <form action="/products" method="get">
            <div>
                <label for="name">Name:
                    <input id="name" type="text" name="name" th:value="${filter.name}">
                </label>
                <label for="price">Price:
                    <input id="price" type="number" name="price" th:value="${filter.price}">
                </label>
                <label for="quantity">Quantity:
                    <input id="quantity" type="number" name="quantity" th:value="${filter.quantity}">
                </label>
            </div>
            <br>
            <button type="submit">Filter</button>
            <br><br>
            <label for="pageSize">Items per page:</label>
            <select id="pageSize" name="size" onchange="this.form.submit()">
                <option value="5" th:selected="${page.size == 5}">5</option>
                <option value="10" th:selected="${page.size == 10}">10</option>
                <option value="20" th:selected="${page.size == 20}">20</option>
            </select>
        </form>
    </div>
    <br>
    <div class="product-grid">
        <div class="product-items" th:each="product : ${page.content}">
            <div class="product">
                <div th:if="${product.image}" class="product-image">
                    <img th:src="@{/api/v1/products/{id}/image(id=${product.id})}" alt="Image" height="200">
                </div>
                <div class="product-info">
                    <div class="product-name" th:text="${product.name}"></div>
                    <div class="product-description" th:text="${product.description}"></div>
                    <div class="product-price" th:text="${product.price}"></div>

                    <!-- Link to product details page -->
                    <div class="product-action">
                        <a th:href="@{/products/{id}(id=${product.id})}" class="btn btn-primary" role="button">Show</a>
                    </div>
                </div>
            </div>
        </div>

        <div class="pagination">
            <nav aria-label="Page navigation">
                <ul class="pagination justify-content-center">

                    <!-- Previous Page Link -->
                    <li class="page-item" th:classappend="${page.first ? 'disabled' : ''}">
                        <a class="page-link"
                           th:href="@{${#httpServletRequest.requestURI}(page=${page.number - 1}, size=${page.size})}"
                           aria-label="Previous">
                            <span aria-hidden="true">&laquo;</span>
                            <span class="sr-only">Previous</span>
                        </a>
                    </li>

                    <!-- First Page Link -->
                    <li class="page-item" th:classappend="${page.number == 0 ? 'active' : ''}">
                        <a class="page-link"
                           th:href="@{${#httpServletRequest.requestURI}(page=0, size=${page.size})}">1</a>
                    </li>

                    <!-- Dots before current page -->
                    <li class="page-item" th:if="${page.number > 3}">
                        <span class="page-link">...</span>
                    </li>

                    <!-- Pages around current page -->
                    <li class="page-item"
                        th:each="i : ${#numbers.sequence(Math.max(1, page.number - 2), Math.min(page.totalPages - 2, page.number + 2))}">
                        <a class="page-link"
                           th:href="@{${#httpServletRequest.requestURI}(page=${i}, size=${page.size})}"
                           th:text="${i + 1}" th:classappend="${i == page.number ? 'active' : ''}"></a>
                    </li>

                    <!-- Dots after current page -->
                    <li class="page-item" th:if="${page.number < page.totalPages - 4}">
                        <span class="page-link">...</span>
                    </li>

                    <!-- Last Page Link -->
                    <li class="page-item" th:classappend="${page.number == page.totalPages - 1 ? 'active' : ''}">
                        <a class="page-link"
                           th:href="@{${#httpServletRequest.requestURI}(page=${page.totalPages - 1}, size=${page.size})}"
                           th:text="${page.totalPages}"></a>
                    </li>

                    <!-- Next Page Link -->
                    <li class="page-item" th:classappend="${page.last ? 'disabled' : ''}">
                        <a class="page-link"
                           th:href="@{${#httpServletRequest.requestURI}(page=${page.number + 1}, size=${page.size})}"
                           aria-label="Next">
                            <span aria-hidden="true">&raquo;</span>
                            <span class="sr-only">Next</span>
                        </a>
                    </li>

                </ul>
            </nav>
        </div>


    </div>
</div>

<footer th:replace="footer :: footer"></footer>

</body>

</html>
